алгоритм импорта


CREATE TABLE fzip (fzip_id SERIAL PRIMARY KEY, fzip_name VARCHAR(20) NOT NULL);
CREATE TABLE books (book_id SERIAL PRIMARY KEY, id_fzip INTEGER NOT NULL, book_autor VARCHAR(100) NOT NULL, book_name VARCHAR(100) NOT NULL, book_date DATE NOT NULL, code VARCHAR(10) NOT NULL);
CREATE INDEX books_fzip_idx ON books (id_fzip);
CREATE INDEX books_autor_idx ON books (book_autor);
CREATE INDEX books_name_idx ON books (book_name);

id_fzip, book_autor, book_name, book_date, code

описание файлов

моя задачи
1 - составить список файлов inp
2 - импорт данных книг - название, автор, в каком файле



flibusta_fb2_local.inpx\
архив содержит список файлов с архивами книг


списки книг
d.fb2-009373-367300.inp  
d.fb2-172703-173908.inp  
f.fb2-173909-177717.inp


1  автор (поля дополнительно разделены запятыми)
2 жанр
3 название книги (три секции разделителей, состоит из трех частей, некоторые части могут бвть пустымиi)
4 номер файла


Громов,Александр,Николаевич:sf_social:Первый из могиканМир матриархата211011912307451101190fb22008-07-05ru3
Громов,Александр,Николаевич:sf_heroic:Тысяча и один деньМир матриархата11101258747531101250fb22008-07-05ru3
Калугин,Алексей,Александрович:sf_humor:Специалист по выживаниюСборники Алексея Калугина011028413834171102840fb22008-07-05ru4
Корепанов,Алексей,Яковлевич:sf_fantasy:Без маски1105172915131105170fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Чередою бегущие дни110519247851105190fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Горькие яблоки110522902431105220fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Хобби110523204261105230fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Игры на песке110524362891105240fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf_fantasy:Итог110525241721105250fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Казнить нельзя, помиловать110526109761105260fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf_fantasy:Круги рая1105301886871105300fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Множатся тени110533437761105330fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf_fantasy:На сияющих вершинах1105342043861105340fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf_fantasy:Найти Эдем1105355986481105350fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Не поверят110536186251105360fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Победитель110545847581105450fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Последний рубеж11054676701105460fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Прятки110549129701105490fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf_fantasy:Раздумья Атланта1105511388471105510fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf_fantasy:Станция Солярис1105573954451105570fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Стрельба в горах110558239181105580fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Труба Восьмого Ангела110560533311105600fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf_fantasy:Уснувший принц1105613536141105610fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf_fantasy:Вино Асканты1105626254621105620fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf:Воины Армагеддона110563111731105630fb22008-07-06ru
Корепанов,Алексей,Яковлевич:sf_fantasy:Заколдованный остров1105676374431105671fb22008-07-06ru
Бабкин,Михаил,Александрович:Белянин,Андрей,Олегович:Кош,Алекс,:Перумов,Ник,:Пехов,Алексей,Юрьевич:Злотников,Роман,Валерьевич:Зыков,Виталий,Валерьевич:Басов,Николай,Владленович:Головачёв,Василий,:Чёрный,Игорь,Витальевич:Эльтеррус,Иар,:Бычкова,Елена,Александровна:Корнев,Павел,Николаевич:Громыко,Ольга,:Турчанинова,Наталья,Владимировна:Малицкий,Сергей,Вацлавович:sf_action:sf_humor:sf_fantasy:sf:Никого над намиАнтология фантастики200711235012662471123500fb22008-07-25ru4
Брандыс,Мариан,:prose_history:Мария Валевская1265567928791265560fb22008-11-06ru4
Верайн,Нэнси,:sf_fantasy:Prisoner of HavenThe Age of Mortals43672256477953672250fb22014-06-17en
Лактионова,Елена,Георгиевна:prose_contemporary:Свободных мест нет. Рассказы советских времен (сборник)3672403279993672400fb22014-06-17ru
Блэксток,Терри,:prose_contemporary:religion_christianity:Изумрудные окна3672537790533672530fb22014-06-17ru5
Неизвестен,Автор,:sf_action:Чистое небоS.T.A.L.K.E.R.36727116756483672711fb22014-06-17ru
Акунин,Борис,:det_classic:FandorinErast Fandorin (de)13672995720203672990fb22014-06-17de5
Брин,Дэвид,:Стерлинг,Брюс,:Михайлова,Лариса,Григорьевна:Журнал «Сверхновая американская фантастика»,,:де Токвиль,Алексис,:Уитлок,Дин,:Коннер,Майк,:Уайтмэн,Уэйн,:Краус,Элизабет,:sf:periodic:Сверхновая американская фантастика, 1995 № 05-06Антология фантастики19953673008582003673000fb22014-06-17ru
О'Санчес,,:prose_contemporary:child_tale:Я люблю времяСказки (О'Санчес)2404371244712404370fb22007-06-29ru4
Льюис,Клайв Стейплз,:sf:За пределы безмолвной планетыКосмическая трилогия (Льюис)170397380532703970fb22007-06-29ru4
Ван Вогт,Альфред Элтон,:sf_action:Обитель вечности / The House that Stood StillВан Вогт, Альфред. Романы073901281146739010fb22007-06-29ru
Ван Вогт,Альфред Элтон,:sf_action:И вечный бой...The Battle of Forever - ru (версии)073915369862739150fb22007-08-13ru
Ван Вогт,Альфред Элтон,:sf_action:Есть упоение в бою… / The Battle of Forever [= Бесконечная битва; Вечный бой; И вечный бой…]The Battle of Forever - ru (версии)073916328428739160fb22007-06-29ru
Буджолд,Лоис,МакМастер:sf_space:sf:The Mountains of Mourning (a story from "Borders of Infinity")Barrayar2075318287436753180fb22007-06-29en4
Уаймэн,Стэнли,Джон:adv_history:Под кардинальской мантией77752355903777520fb22007-08-13ru
Тюрин,Александр,Владимирович:Щёголев,Александр,Геннадиевич:sf_cyberpunk:sf:child_sf:Клетка для буйных (педагогическая фантастика)Клетка для буйных178506253713785060fb22007-06-29ru5
Шумил,Павел,:sf:К вопросу о долгой жизни7979752175797970fb22007-07-20ru4
Буль,Пьер,:sf_epic:sf_postapocalyptic:Планета обезьян937356018393731fb22007-06-28ru4
Валё,Пер,:Шёвалль,Май,:det_police:Наемные убийцы96303669324963031fb22008-01-27ru4
Ван Вогт,Альфред Элтон,:sf:И вечный бой… / The Battle of Forever98679569502986791fb22008-03-30ru5


Козлова,Наталья,Петровна:nonf_publicism:Классицизм Пьера Корнеля172703551381727030fb22009-11-13ru
Колядич,Татьяна,Михайловна:nonf_publicism:Воспоминания писателей XX века (эволюция, проблематика, типология)1727048366531727040fb22009-11-13ru
Кара-Мурза,Сергей,Георгиевич:sci_politics:Истоpия советского государства и пpава1727056880151727050fb22009-11-13ru1
Кара-Мурза,Сергей,Георгиевич:sci_politics:Научная картина мира, экономика и экология172706927761727060fb22009-11-13ru1
Кара-Мурза,Сергей,Георгиевич:sci_politics:Официальное советское обществоведение и 'незнание общества, в котором мы живем'1727071934051727070fb22009-11-13ru3
Кара-Мурза,Сергей,Георгиевич:sci_politics:Потерянный разум17270839094431727080fb22009-11-13ru3
Кара-Мурза,Сергей,Георгиевич:nonf_biography:«Совок» вспоминает...1727096371271727090fb22009-11-13ru4
Кара-Мурза,Сергей,Георгиевич:sci_politics:Столыпин — отец русской революции1727108336791727100fb22009-11-13ru3
Комаров,Виктор,Ноевич:religion:Атеизм и научная картина мира1727117152221727111fb22009-11-13ru
Шолохов,Игорь,:sf_history:popadancy:Красный ангел смертиПопаданцы - АИ017271215781911727120fb22009-11-13ru1
Раскин,Александр,Борисович:nonf_biography:Воспоминания об Илье Ильфе и Евгении Петрове17271310002441727130fb22009-11-13ru
Спинрад,Норман,Ричард:sf_history:popadancy:Стальная мечтаПопаданцы - АИ017271412708741727141fb22009-11-13ru
Есенин,Константин,Сергеевич:home_sport:Футбол: сборная СССР17271518557711727150fb22009-11-13ru
Продель,Гюнтер,:det_history:sci_history:Вбивці на борту17271616741261727160fb22009-11-13uk
Херберт,Фрэнк,:sf_epic:sf_social:Dune MessiahDune21727174698031727171fb22009-11-13en
Спинрад,Норман,Ричард:sf_history:popadancy:Стальная мечтаПопаданцы - АИ017271813281841727180fb22009-11-13ru4
Спинрад,Норман,Ричард:sf:Агент Хаоса17271910259821727190fb22009-11-13ru4
Аллен,Вуди,:humor_prose:Шлюха из Менсы172721207731727210fb22009-11-13ru5
Клавелл,Джеймс,:adv_history:Благородный дом. Роман о Гонконге.17272258529001727221fb22009-11-13ru5экономический, восток
Аллен,Вуди,:humor_prose:The Whore of Mensa172723132141727230fb22009-11-13en
Мазурин,Олег,Владимирович:det_action:network_literature:В ходе ожесточенных боев17272410625521727240fb22009-11-13ru1
Леви,Владимир,Львович:sci_psychology:Цвет судьбы1727255308181727250fb22009-11-13ru
Семак,Рита,:comp_db:3ds Max 2008 для дизайна интерьеров172726120214031727260fb22009-11-13ru4
Щеглов,Дмитрий,Алексеевич:child_tale:Княжна Анастасия1727271239571727270fb22009-11-13ru
Гареев,Зуфар,:prose_contemporary:Показания Шерон СтоунСовременная проза11727282791251727280fb22009-11-13ru
Денисов,Вячеслав,Юрьевич:det_action:Топор правосудияСудья Струге01727299939241727290fb22009-11-13ru5
Денисов,Вячеслав,Юрьевич:det_action:Трибунал для судьиСудья Струге017273011477021727300fb22009-11-13ru4
Денисов,Вячеслав,Юрьевич:sf_horror:Бермудский артефактОстров. Остаться людьми01727317753631727310fb22009-11-13ru3
Денисов,Вячеслав,Юрьевич:det_action:Тюремный романс1727327273441727320fb22009-11-13ru4
Денисов,Вячеслав,Юрьевич:det_action:Иди и умриСудья Струге01727334930601727330fb22009-11-13ru5
Томпсон,Хантер,С.:prose_counter:Fear and Loating in Las Vegas. A Savage Journey to the Heart of the American Dream1727353290301727351fb22009-11-13endrug drugs hallucination
Томпсон,Хантер,С.:prose_counter:Fear and Loating in Las Vegas. A Savage Journey to the Heart of the American Dream1727363291191727361fb22009-11-13endrug drugs hallucination
Томпсон,Хантер,С.:prose_counter:Fear and Loathing in Las Vegas. A Savage Journey to the Heart of the American Dream1727373292601727370fb22009-11-13en5drug drugs hallucination
Мельников,Илья,Валерьевич:banking:Бухгалтерский учет17274210640661727420fb22009-11-13ru2
Мельников,Илья,Валерьевич:home_garden:Теплица, парник, зимний сад1727435025151727430fb22009-11-13ru


архивы с книгами
d.fb2-009373-367300.zip  
d.fb2-172703-173908.zip


каждому файлу inp соответствует файл zip


